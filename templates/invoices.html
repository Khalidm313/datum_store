{% extends "base.html" %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">أرشيف الفواتير</h1>
</div>

<div class="card">
    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>التاريخ</th>
                <th>العميل</th>
                <th>المبلغ</th>
                <th>الحالة</th>
                <th>إجراءات</th>
            </tr>
        </thead>
        <tbody>
            {% for inv in invoices %}
            <tr>
                <td style="color: var(--primary); font-weight: bold;">#{{ inv.id }}</td>
                <td style="color: var(--text-muted);">{{ inv.date.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ inv.customer_name or '-' }}</td>
                <td style="font-weight: bold;">{{ inv.total_amount }}</td>
                <td>
                    {% if inv.status == 'paid' %}<span style="background: rgba(16,185,129,0.1); color: var(--success); padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">مدفوع</span>
                    {% elif inv.status == 'pending' %}<span style="background: rgba(245,158,11,0.1); color: var(--warning); padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">آجل</span>
                    {% else %}<span style="background: rgba(239,68,68,0.1); color: var(--danger); padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">مسترجع</span>{% endif %}
                </td>
                <td>
                    <a href="{{ url_for('print_invoice', id=inv.id) }}" target="_blank" class="btn" style="padding: 6px 10px; background: transparent; border: 1px solid var(--border-color); color: var(--text-muted);"><i class="fas fa-print"></i></a>
                    {% if inv.status == 'pending' %}
                    <a href="{{ url_for('pay_invoice', id=inv.id) }}" class="btn" style="padding: 6px 10px; background: rgba(16,185,129,0.1); color: var(--success);" title="تسديد"><i class="fas fa-check"></i></a>
                    {% endif %}
                    {% if inv.status != 'refunded' %}
                    <a href="{{ url_for('refund_invoice', id=inv.id) }}" class="btn" style="padding: 6px 10px; background: rgba(245,158,11,0.1); color: var(--warning);" title="استرجاع"><i class="fas fa-undo"></i></a>
                    {% endif %}
                    <a href="{{ url_for('delete_invoice', id=inv.id) }}" class="btn" style="padding: 6px 10px; background: rgba(239,68,68,0.1); color: var(--danger);" title="حذف"><i class="fas fa-trash"></i></a>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="6" style="text-align: center; padding: 40px; color: var(--text-muted);">الأرشيف فارغ</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
